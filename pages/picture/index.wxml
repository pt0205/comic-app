<view class='container' bindtouchstart='touchStartHandle' bindtouchmove='touchMoveHandle' bindtouchend='touchEndHandle'>
    <!-- 标题栏 -->
    <navigationBar external-classes='custom_nav {{showTitle ? "active" : ""}}' title='{{title}}' holder='{{false}}' background='rgba(0,0,0,0.8)'></navigationBar>
    <!-- 阅读区 -->
    <scroll-view class='scroll_w' scroll-y scroll-top='{{scrollTop}}' upper-threshold='2000px' lower-threshold='2000px' bindscrolltolower='onLolower' bindscrolltoupper='onUpper' bindscroll='scroll' scroll-into-view='{{picIndex}}' scroll-with-animation="{{scrollAnimation}}">
        <!-- <view style='visibility:{{topLoadingTip ? "visible" : "hidden"}}' class='top_loading' bindtap='onPreChapter'>{{topLoadingTip}}</view> -->
        <view class='image_horizontal_scroll_w'>
            <view class='image_w' style='width:{{imgScale*100+"%"}};'>
                <block wx:for='{{pics}}' wx:key='{{index}}' wx:for-item='pItem'>
                    <block wx:for='{{pItem}}' wx:key='{{item.url}}'>
                        <image wx:if='{{item.url}}' src='{{item.url}}' style='width:100%;height:auto;' class='{{"chapter_"+item.chapterid}}' id='{{index==0 || item.chapterid!= pics[index-1].chapterid ? "chapter_"+item.chapterid : "pic_"+index}}' lazy-load='{{true}}' mode='widthFix' data-index='{{index}}' bindtap='clickToScale'></image>
                        <view wx:else class='bad_chapter' style='height:{{systemInfo.screenHeight}}px' data-index='{{index}}' bindtap='clickToScale'>第{{item.chapterIndex+1}}章节被破坏</view>
                    </block>   
                </block>
            </view>
        </view>
        <view wx:if='{{bottomLoadingTip}}' class='bottom_loading' id="bottom_loading">{{bottomLoadingTip}}</view>
    </scroll-view>
    <!-- 底部菜单 -->
    <view class='bottom_btn_w {{showBootomBtn ? "active" : ""}}'>
        <!-- 进度调整 -->
        <view class='process_w' wx:if="{{nowMenu==1}}">
            <view class='pre_chapter' bindtap='onPreChapter'><image mode='widthFix' src='/image/icon_left.png'></image></view>
            <slider class='slider' value='{{nowChapterIndex+1}}' bindchange="sliderChange" activeColor='#7e6353' block-color='#7e6353' block-size='18' show-value='{{true}}' step="1" min="1" max="{{chapterList.length}}"/>
            <view class='total'>/{{chapterList.length}}</view>
            <view class='next_chapter' bindtap='onNextChapter'><image mode='widthFix' src='/image/icon_left.png' style='transform:rotate(180deg)'></image></view>
        </view>
        <!-- 亮度调整 -->
        <view class='light_w' wx:if="{{nowMenu==2}}">
            <view class='light_slider_w'>
                <image src='/image/icon_light.png'  style='width:40rpx;height:40rpx;'></image>
                <slider class='slider' value='{{light}}' bindchange="lightChange" activeColor='#7e6353' block-color='#7e6353' block-size='18' step="0.1" min="0" max="1"/>
                <image src='/image/icon_light.png' style='width:60rpx;height:60rpx;'></image>
            </view>
            <view class='light_switch_w'>
                <text>跟随系统亮度</text>
                <switch checked='{{switchChecked}}' bindchange="switchChange" color='#7e6353'/>
            </view>
        </view>
        <!-- 菜单icon -->
        <view class='bottom_menu_w'>
            <view class='menu_item {{nowMenu==0 ? "active" : ""}}' data-index='{{0}}' bindtap='menuChange'><image mode='aspectFit' src='/image/icon_menu_chapter.png' style='height:26rpx;margin-top:7rpx'></image><text>目录</text></view>
            <view class='menu_item {{nowMenu==1 ? "active" : ""}}' data-index='{{1}}' bindtap='menuChange'><image mode='aspectFit' src='/image/icon_process.png' style='height:30rpx;margin-top:5rpx'></image><text>进度</text></view>
            <view class='menu_item {{nowMenu==2 ? "active" : ""}}' data-index='{{2}}' bindtap='menuChange'><image mode='aspectFit' src='/image/icon_light.png' style='height:40rpx'></image><text>亮度</text></view>
        </view>
    </view>
    <!-- 目录列表 -->
    <view class='catalog_w {{nowMenu==0 ? "active" : ""}}'style='padding-top:{{statusBarHeight}}px'>
        <!-- 目录背景 -->
        <view class='catalog_bg' style='background:url({{pics[0][0].url}}) no-repeat center;background-size:cover'></view>
        <scroll-view scroll-y class='catalog_scroll_w'>
            <view class='catalog_item' wx:for='{{chapterList}}' wx:key='{{item.id}}' data-index='{{index}}' style='color:{{nowChapterIndex==index ? "#38ffff" : "#fff"}}' bindtap='gotoChapter'>{{item.name || '第'+(chapterList.length-index)+'章'}}</view>
        </scroll-view>
    </view>
    <view class='scroll_top {{showBootomBtn?"active":""}}' bindtap='scrollToTop'><image mode='widthFix' src='/image/icon_top.png'></image></view>
</view>